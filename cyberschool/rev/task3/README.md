передача данных происходит с помощью **tcp_header->seq, tcp_header->ack_seq, tcp_header->check**

Значение **tcp_header->seq** == 0х12345678 означает начало передачи данных, при этом сохраняется в глобальную переменную **key** значение  из **tcp_header->ack_seq**, обнуляется буфер и переменная обозначающая передачу данных **is_transmiting** = 1.

В последующих пакетах, у которых **tcp_header->seq** == **key**, значение **tcp_header->ack_seq** является командой.

Если в следующем пакете **tcp_header->ack_seq** > 0x400, то передача заканчивается и программа уходит в бесконечный цикл.

Если **tcp_header->ack_seq** <= 0x400, то это значение используется в качестве размера буфера, который будет передан.

В последующих пакетах **tcp_header->ack_seq** передает int32 значение, а  высший байт из **tcp_header->check** используется в качестве смещения в буфере куда кладутся данные.

В конце, если **tcp_header->ack_seq** == 0xdeadfa11, то заполненный буфер шифруется по следующему алгоритму:

```c
char *encrypt(char *buff, size_t size)
{
  char key; 
  int i; 
  char *out;

  out = (char *)malloc(size);
  key = 0x95;
  for ( i = 0; size > i; ++i )
  {
    out[i] = key ^ buff[i];
    key = key * key + 25;
  }
  return out;
}
```

